<template>
  <require from="./process-solution-panel.css"></require>
  <div class="process-explorer__solution-explorer">

    <div class="solution-explorer-index-cards">
      <div class="index-card" class.bind="fileSystemIndexCardIsActive ? 'index-card--active' : ''" click.delegate="openFileSystemIndexCard()" if.bind="enableFileSystemSolutions">
        <i class="fa fa-folder"></i>
      </div>
      <div class="index-card" class.bind="processEngineIndexCardIsActive ? 'index-card--active' : ''" click.delegate="openProcessEngineIndexCard()">
        <i class="fa fa-server"></i>
      </div>
    </div>

    <!--FileSystem-->
    <div class="solution-explorer__filesystem" show.bind="fileSystemIndexCardIsActive && enableFileSystemSolutions">
      <!--Single Diagrams-->
      <div class="single-diagrams">
        <div class="process-explorer__heading">
          Opened Diagrams
          <div class="control-buttons">
            <button ref="openSingleDiagramButton" class="control-buttons__open-single-file" click.delegate="singleDiagramInput.click()" title="Open a diagram">
              <i class="fas fa-file-medical"></i>
            </button>
            <button ref="openSolutionButton" class="control-buttons__open-solution" click.delegate="solutionInput.click()" title="Open a solution">
              <i class="fas fa-folder-open"></i>
            </button>
            <button click.delegate="refreshSolutions()" class="control-buttons__refresh-explorer" title="Refresh explorer">
              <i class="fas fa-sync"></i>
            </button>
          </div>
        </div>
        <input class="single-diagram-input" ref="singleDiagramInput" type="file" change.delegate="onSingleDiagramInputChange($event)" id="singleFileInput">
        <div repeat.for="diagram of openedSingleDiagrams" class="process-explorer__structure-item">
          <a click.delegate="navigateToDiagramDetail(diagram)">${diagram.name}</a>
          <i class="fas fa-times single-diagram-close" click.delegate="closeSingleDiagram(diagram)"></i>
        </div>
      </div>
      <!--Solutions-->
      <div class="filesystem-solutions" if.bind="openedFileSystemSolutions.length > 0">
        <div class="process-explorer__heading">Opened Solutions</div>
        <div repeat.for="solution of openedFileSystemSolutions">
          <div class="solution-headline">
            <i class="fa fa-folder-open"></i>
            ${solution.name}
            <i class="fas fa-times solution-close" click.delegate="closeFileSystemSolution(solution)"></i>
          </div>
          <div repeat.for="diagram of solution.diagrams" class="process-explorer__structure-item">
            <a click.delegate="navigateToDiagramDetail(diagram)">${diagram.name}</a>
          </div>
        </div>
      </div>
      <div class="solution-input-group">
        <button id="openFirstSolutionButton" if.bind="openedFileSystemSolutions.length === 0" click.delegate="solutionInput.click()">Open a Solution</button>
        <input class="solution-input" ref="solutionInput" type="file" change.delegate="onSolutionInputChange($event)" id="solutionInput" webkitdirectory>
      </div>
    </div>
    <!--Process Engine-->
    <div class="solution-explorer__process-engine" if.bind="processEngineIndexCardIsActive">
      <div class="process-explorer__heading">Solution Explorer</div>
      <div repeat.for="diagram of openedProcessEngineSolution.diagrams" class="process-explorer__structure-item">
        <a href="#/processdef/${diagram.id}/detail">${diagram.name}</a>
      </div>
    </div>
  </div>
</template>
